<!DOCTYPE html>
<html class='test'>
    <head>
        <meta charset="utf-8">
        <title>Point on a map D3</title>
        <script src="/socket.io/socket.io.js"></script>
        <script src="http://d3js.org/d3.v4.min.js"></script>
        <script src="http://d3js.org/topojson.v2.min.js"></script>
        <script src="https://unpkg.com/d3-composite-projections@1.2.0"></script>

        <style type="text/css">

            #wrapper {
                text-align:center
            }

            .feature {
                fill: none;
                stroke: grey;
                stroke-width: 1px;
                stroke-linejoin: round;
            }

            .input-container {
                display: inline-block;
                vertical-align: bottom;
                margin-right: 30px;
                margin-left: 30px;
            }

             .mesh {
                fill: none;
                stroke: lightgrey;
                stroke-width: 2px;
                stroke-linejoin: round;
            }
            
            h1 {
                font-family: sans-serif;
            }
</style>
</head>
<body>
<div id="wrapper">
    <div id="date-input">
        <div class="input-container">
            Start Date <br>
            <input type="date" id="start-date">
            <br>
            <span><p></span>
        </div>
        <div class="input-container">
            End Date <br>
            <input type="date" id="end-date">
            <br>
            <span><p></span>
        </div>
        <div class="input-container">
            <button type="button">Submit</button>
        </div>
    </div>
    <div id="svg-container">
    </div>
</div>
<script type="text/javascript">

    // minimum date is 2012-01-01
    var minDate = new Date(2012, 00, 01);
    // maximum date is 2014-12-31
    var maxDate = new Date(2015, 00, 00);

    d3.selectAll('#date-input')
            .select('input')
            .on('input', function() { console.log('inputted'); 
                                               valiDate( this );} );
    
    /* <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M20.285 2l-11.285 11.567-5.286-5.011-3.714 3.716 9 8.728 15-15.285z"/></svg>*/

    function valiDate(elem) {
    
        var input = d3.select(elem).property("value");
        var inputDateSplit = input.split("-");
        var inputDate = new Date(+inputDateSplit[0], +inputDateSplit[1] - 1,  +inputDateSplit[2], 0, 0);

        var infoText;        
        var spanClass;
        
        if ((inputDate < minDate) || (inputDate > maxDate)) {

            console.log("date not in range!");
            infoText = "Date not in range of " + minDate.toLocaleString("en-US") + " to " + maxDate.toLocaleString("en-US");
            spanCol = "red";
        } else {

            infoText = "Valid date";
            spanCol = "green";
        }
            // .toLocaleDateString("en-US")
            d3.select(elem.parentNode)
                        .select("span")
                        .transition()
                        .duration(1000)
                        .on("start", function () {
                            var t = d3.active(this)
                                .style("opacity", 0)
                                //.remove()
                                ;
                            
                            d3.select(this)
                                .style("opacity", 0)
                                .text(infoText)
                                .transition(t)
                                .style("opacity", 1)
                                .style("color", spanCol)
                                .attr("class", spanClass);
                        });
       
    }


</script>
</body>
